<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.faraway.domain.hotplace.repository.HotPlaceCommentRepository">
    <insert id="save" parameterType="HotPlaceComment">
        insert into hotplace_comment (hotplace_id, member_id, content)
        values (#{hotPlaceId}, #{memberId}, #{content})
    </insert>

    <select id="findAllByHotPlaceId" parameterType="long" resultType="HotPlaceCommentListResponseDto">
        select hc.id, hc.member_id, m.login_id, hc.content, hc.modified_date
        from hotplace_comment hc
        join hotplace h
        on hc.hotplace_id = h.id
        join member m
        on hc.member_id = m.id
        and hc.hotplace_id = #{id}
    </select>

    <update id="update" parameterType="HotPlaceCommentUpdateRequestDto">
        update hotplace_comment
        set content = #{content}
        where id = #{id} and hotplace_id = #{hotPlaceId} and member_id = #{memberId}
    </update>
</mapper>